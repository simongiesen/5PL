<!DOCTYPE html>
<html>
<head>
  <title>5PL Curve Fit</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
</head>
<body>

  <script>
     
	// Beispiel-Daten
	var xData = [1, 2, 3, 4, 5]; // x-Werte
	var yData = [0.1, 0.3, 0.6, 0.8, 0.9]; // y-Werte

	// Fit-Parameter sch채tzen
	var initialParams = [1, 0, 3, 1, 1]; // [top, bottom, EC50, slope, hillSlope]
	var fittedParams = fitCurve(xData, yData, initialParams);

	// Ergebnisse ausgeben
	console.log("Top:", fittedParams[0]);
	console.log("Bottom:", fittedParams[1]);
	console.log("EC50:", fittedParams[2]);
	console.log("Slope:", fittedParams[3]);
	console.log("Hill Slope:", fittedParams[4]);

	// Generiere Vorhersagen f체r neue x-Werte
	var new_x = [6, 7, 8, 9, 10]; // Neue x-Werte f체r Vorhersagen
	var predictions = [];

	for (var i = 0; i < new_x.length; i++) {
	  var x = new_x[i];
	  var prediction = fivePLCurveFit(x, fittedParams[0], fittedParams[1], fittedParams[2], fittedParams[3], fittedParams[4]);
	  predictions.push(prediction);
	}

	console.log("Predictions for new x-values:", predictions);


	// Funktion f체r den 5PL-Curve-Fit
	function fivePLCurveFit(x, top, bottom, EC50, slope, hillSlope) {
	  var response = bottom + ((top - bottom) / (1 + Math.pow((x / EC50), hillSlope))) * Math.pow((x / EC50), slope);
	  return response;
	}

	// Curve-Fit-Funktion
	function fitCurve(xData, yData, initialParams) {
	  var fittedParams = numeric.uncmin(function(params) {
		var residuals = [];

		for (var i = 0; i < xData.length; i++) {
		  var x = xData[i];
		  var y = yData[i];
		  var modelY = fivePLCurveFit(x, params[0], params[1], params[2], params[3], params[4]);
		  var residual = y - modelY;
		  residuals.push(residual);
		}

		return numeric.norm2(residuals);
	  }, initialParams);

	  return fittedParams.solution;
	}

	   
  </script>

</body>
</html>
